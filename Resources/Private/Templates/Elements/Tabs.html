{namespace v=Tx_Vhs_ViewHelpers}
{namespace flux=Tx_Flux_ViewHelpers}

<f:layout name="FCE" />

<f:section name="Configuration">
	<flux:flexform id="tabs" label="Tabs with content elements" description="Places child content elements in tabs." enabled="TRUE" wizardTab="vantomas">
		<flux:flexform.sheet name="display" label="Display">
		</flux:flexform.sheet>

		<flux:flexform.sheet name="tabs" label="Tabs">
			<flux:flexform.section name="tabs" label="Tabs">
				<flux:flexform.object name="tab" label="Tab">
					<flux:flexform.field.input name="title" label="Tab title" />
					<flux:flexform.field.input name="class" label="Additional class names" />
					<flux:flexform.field.checkbox name="active" label="Active?" />
				</flux:flexform.object>
			</flux:flexform.section>
		</flux:flexform.sheet>

		<flux:flexform.grid>
			<flux:flexform.grid.row>
				<f:if condition="{tabs}">
					<f:for each="{tabs}" as="tab" iteration="iteration">
						<flux:flexform.grid.column style="width: {v:math.division(b: '{tabs -> f:count()}', a: 100)}%">
							<flux:flexform.content name="content.{iteration.index}" label="Content, tab {iteration.cycle}" />
						</flux:flexform.grid.column>
					</f:for>
				</f:if>
			</flux:flexform.grid.row>
		</flux:flexform.grid>
	</flux:flexform>
</f:section>

<f:section name="Preview">
	<flux:widget.grid />
</f:section>

<f:section name="Main">
	<v:var.set name="activeTabIndex" value="0" />
	<f:if condition="{tabs}">
		<f:for each="{tabs}" as="tab" iteration="iteration">
			<f:if condition="{tab.tab.active}">
				<v:var.set name="activeTabIndex" value="{iteration.index}" />
			</f:if>
		</f:for>
	</f:if>

	<div class="tabbable tabs-above">
		<f:render section="Tabs" arguments="{_all}" />

		<div class="tab-content">
			<f:if condition="{tabs}">
				<f:for each="{tabs}" as="tab" iteration="iteration">
					<div class="tab-pane {f:if(condition: '{activeTabIndex} == {iteration.index}', then: 'active in')}" id="tab-{record.uid}-{iteration.index}">
						<flux:flexform.renderContent area="content.{iteration.index}" />
					</div>
				</f:for>
			</f:if>
		</div>
	</div>

	<vhs:page.footer>
		<script type="text/javascript" src="/typo3conf/ext/vantomas/Resources/Public/Javascript/Desktop/tabs.js"></script>
	</vhs:page.footer>
</f:section>

<f:section name="Tabs">
	<f:if condition="{tabs}">
		<ul class="nav nav-tabs default">
			<f:for each="{tabs}" as="tab" iteration="iteration">
				<li class="nav-link {f:if(condition: '{activeTabIndex} == {iteration.index}', then: 'active')}">
					<a href="{v:page.absoluteUrl()}#tab-{record.uid}-{iteration.index}" data-toggle="{mode}">{tab.tab.title}</a>
				</li>
			</f:for>
		</ul>
	</f:if>
</f:section>