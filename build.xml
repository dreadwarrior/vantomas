<?xml version="1.0" encoding="UTF-8"?>
<project name="vantomas" default="run">

	<property name="release.run.postComposer" value="installNodeAndBower" />
	<property name="typo3.copy-extensions.project.preCopyDist" value="runGrunt" />

	<import file="./vendor/dreadlabs/typo3-build/build.xml" />

	<target name="run">
		<phingcall target="build.main:run" />
	</target>

	<target name="installNodeAndBower">
		<echo>Installing node.js modules and bower components</echo>
		<exec
			dir="/tmp/tmp-${phing.project.name}"
			command="/usr/bin/env npm install"
			passthru="true" />
		<exec
			dir="/tmp/tmp-${phing.project.name}"
			command="/usr/bin/env bower install --config.interactive=false"
			passthru="true" />
	</target>

	<target name="runGrunt">
		<exec
			command="/usr/bin/env grunt build"
			passthru="true"
			checkreturn="true" />
	</target>
</project>